version: "3.9"

services:
  fluent-bit:
    image: fluent/fluent-bit:4.2
    container_name: fluent-bit
    volumes:
      # 設定ファイルをホストからマウント（編集可能に）
      - ./fluent-bit.conf:/fluent-bit/etc/fluent-bit.conf:ro
      - ./parsers.conf:/fluent-bit/etc/parsers.conf:ro

      # ホスト側ログファイル（またはディレクトリ）をマウント
      - ./apps.log:/var/log/apps.log:ro

    # ホスト上のサービスにHTTP送信したいので host.docker.internal を解決できるようにする
    extra_hosts:
      - "host.docker.internal:host-gateway"

    # 必要なら healthcheck や restart 設定など
    restart: unless-stopped
